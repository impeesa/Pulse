.block
  .secondary-navigation
    %ul.wat-cf
      %li.first= link_to "Index", results_path
      %li.last.active= link_to "Table", results_table_path
  .content
    %table
      %caption Sales Results
      %thead
        %tr
          %th
            - @terms.each do |db_name, display_name|
              %th{:colspan => 3}= display_name
        %tr
          %th
          - @terms.each do
            - @types.each do |db_name, display_name|
              %th= display_name
      %tfoot
        %tr
          %th Total
          - @terms.each do |term_db_name, term_display_name|
            - @types.each do |type_db_name, type_display_name|
              %td= @results.classes(@classes.values).terms(term_db_name).types(type_db_name).sum(:Value).try(:to_currency)
      %tbody
        %tr
          %th Equal
          - @terms.each do
            - @types.each do
              %td
        - @classes.each do |class_db_name, class_display_name|
          %tr.types
            %th= class_display_name
            - @terms.each do |term_db_name, term_display_name|
              - @types.each do |type_db_name, type_display_name|
                %td= @results.classes(class_db_name).terms(term_db_name).types(type_db_name).first.try(:Value).try(:to_currency)
